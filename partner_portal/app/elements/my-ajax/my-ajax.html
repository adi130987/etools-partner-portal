

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<!--
An element providing a solution to no problem in particular.

Example:

    <my-customel></my-customel>

@group Seed Elements
@element my-customel
@demo demo/index.html
@hero hero.svg
-->
<dom-module id="my-ajax">

  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <div> woohoo </div>
    <content></content>
    <iron-ajax
          auto
          id="ajax"
          url="{{url}}"
          params="{{options}}"
          handle-as="json"
          on-response="handleResponse"
          last-response="{{mresponse}}"
          debounce-duration="300">
    </iron-ajax>



  </template>

</dom-module>

<script>
(function() {
  'use strict';

  Polymer({

    is: 'my-ajax',

    properties: {
      mresponse: {
        type: Array,
        notify: true
      },
      ajaxresponse: {
        type: Array,
        notify: true
      },
      owner: {
        value: 'polymer',
        notify: true
      },
      repo: {
        value: 'polymer',
        notify: true
      },
      url: {
        computed: 'computeUrl(owner, repo)'
      },
      opt: {
        type: Object,
        value: {}
      },
      options: {
        computed: 'computeOptions(opt)'
      },
    },
    computeOptions: function(data) {
      return data;
    },
    computeUrl: function(owner, repo) {
      return ['https://api.github.com/repos', owner, repo, 'issues'].join('/');
    },
    handleResponse: function(rsp) {
      // console.log(rsp.detail.xhr.response, rsp.detail, rsp.response)
      // console.log(rsp);
      this.ajaxresponse = rsp.detail.xhr.response;
    },
    handleLast: function(lrsp) {
      console.log(lrsp);
      this.ajaxresponse = lrsp;
    },
  });
})();

</script>